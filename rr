# keywin.ps1 - Ativador KMS Profissional (Windows + Office)
# Criado por Jo√£o Victor - Para uso educacional/t√©cnico

function Ativar-Windows {
    Write-Host "`nüîë Ativando Windows..." -ForegroundColor Cyan
    $chave = "W269N-WFGWX-YVC9B-4J6C9-T83GX" # Windows 10/11 Pro VL
    slmgr /ipk $chave
    slmgr /skms kms.luoda.cn
    slmgr /ato
    Write-Host "`n‚úÖ Windows ativado com sucesso!" -ForegroundColor Green
    Pause
}

function Ativar-Office {
    Write-Host "`nüîë Procurando Office instalado..." -ForegroundColor Cyan
    $dirs = @(
        "C:\Program Files\Microsoft Office\Office16",
        "C:\Program Files (x86)\Microsoft Office\Office16",
        "C:\Program Files\Microsoft Office\Office15",
        "C:\Program Files (x86)\Microsoft Office\Office15"
    )

    foreach ($dir in $dirs) {
        if (Test-Path "$dir\ospp.vbs") {
            cd $dir
            Write-Host "‚úî Office localizado em: $dir" -ForegroundColor Yellow
            cscript ospp.vbs /sethst:kms.luoda.cn
            cscript ospp.vbs /act
            Write-Host "`n‚úÖ Office ativado com sucesso!" -ForegroundColor Green
            Pause
            return
        }
    }

    Write-Host "‚ùå Office n√£o localizado em diret√≥rios padr√£o." -ForegroundColor Red
    Pause
}

function Verificar-Status-Windows {
    Write-Host "`nüìã Status do Windows:" -ForegroundColor Cyan
    slmgr /xpr
    Pause
}

function Verificar-Status-Office {
    Write-Host "`nüìã Status do Office:" -ForegroundColor Cyan
    $dirs = @(
        "C:\Program Files\Microsoft Office\Office16",
        "C:\Program Files (x86)\Microsoft Office\Office16"
    )
    foreach ($dir in $dirs) {
        if (Test-Path "$dir\ospp.vbs") {
            cd $dir
            cscript ospp.vbs /dstatus
            Pause
            return
        }
    }
    Write-Host "‚ùå Office n√£o localizado para status." -ForegroundColor Red
    Pause
}

function Alterar-KMS {
    $novo = Read-Host "`nüåê Digite o novo servidor KMS"
    slmgr /skms $novo
    Write-Host "`n‚úî Servidor KMS atualizado para: $novo" -ForegroundColor Green
    Pause
}

function Instalar-Chave {
    $chave = Read-Host "`nüß© Digite a chave do produto (VL)"
    slmgr /ipk $chave
    Write-Host "‚úÖ Chave instalada com sucesso!" -ForegroundColor Green
    Pause
}

function Redefinir-Ativacao {
    Write-Host "`n‚ôª Redefinindo estado de ativa√ß√£o do Windows..." -ForegroundColor Cyan
    slmgr /rearm
    Write-Host "‚úî Ativa√ß√£o reiniciada. Reinicie o PC para aplicar." -ForegroundColor Yellow
    Pause
}

function Menu-KeyWin {
    do {
        Clear-Host
        Write-Host "====================================" -ForegroundColor Yellow
        Write-Host "         üîê KEYWIN - KMS PRO         " -ForegroundColor Red
        Write-Host "====================================" -ForegroundColor Yellow
        Write-Host "[1] Ativar Windows"
        Write-Host "[2] Ativar Office"
        Write-Host "[3] Verificar status do Windows"
        Write-Host "[4] Verificar status do Office"
        Write-Host "[5] Alterar servidor KMS"
        Write-Host "[6] Instalar nova chave VL"
        Write-Host "[7] Redefinir ativa√ß√£o (Rearm)"
        Write-Host "[0] Sair"
        $op = Read-Host "`nEscolha uma op√ß√£o"

        switch ($op) {
            "1" { Ativar-Windows }
            "2" { Ativar-Office }
            "3" { Verificar-Status-Windows }
            "4" { Verificar-Status-Office }
            "5" { Alterar-KMS }
            "6" { Instalar-Chave }
            "7" { Redefinir-Ativacao }
            "0" { break }
            default { Write-Host "‚ùå Op√ß√£o inv√°lida"; Pause }
        }
    } while ($true)
}

Menu-KeyWin
